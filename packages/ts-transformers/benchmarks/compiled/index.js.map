{"version":3,"file":"index.js","sourceRoot":"","sources":["../src/index.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nimport {html, LitElement, css, PropertyDeclaration, render} from 'lit';\nimport {customElement, property} from 'lit/decorators.js';\n\nconst queryParams: {\n  [index: string]: string | boolean | number;\n} = document.location.search\n  .slice(1)\n  .split('&')\n  .filter((s) => s)\n  .map((p) => p.split('='))\n  .reduce(\n    (p: {[key: string]: string | boolean}, [k, v]) => (\n      (p[k!] = (() => {\n        try {\n          return JSON.parse(v!);\n        } catch {\n          return v || true;\n        }\n      })()),\n      p\n    ),\n    {}\n  );\n\n// Settings\nconst itemCount = 250;\nconst itemValueCount = 99;\nconst updateCount = 6;\n\ntype SimpleItem = {[index: string]: string};\n\nfunction makeItem(prefix: number) {\n  const o: SimpleItem = {};\n  for (let i = 0; i < itemValueCount; i++) {\n    o['value' + i] = prefix + ': ' + i;\n  }\n  return o;\n}\n\nfunction generateData(count: number) {\n  const data = [];\n  for (let i = 0; i < count; i++) {\n    data.push(makeItem(i));\n  }\n  return data;\n}\n\nconst data = generateData(itemCount);\nconst otherData = generateData(itemCount * 2).slice(itemCount);\n\nconst propertyOptions: PropertyDeclaration = {};\n\n@customElement('x-thing')\nexport class XThing extends LitElement {\n  static override styles = css`\n    .container {\n      box-sizing: border-box;\n      height: 80px;\n      padding: 4px;\n      padding-left: 77px;\n      line-height: 167%;\n      cursor: default;\n      background-color: white;\n      position: relative;\n      color: black;\n      background-repeat: no-repeat;\n      background-position: 10px 10px;\n      background-size: 60px;\n      border-bottom: 1px solid #ddd;\n    }\n\n    .from {\n      display: inline;\n      font-weight: bold;\n    }\n\n    .time {\n      margin-left: 10px;\n      font-size: 12px;\n      opacity: 0.8;\n    }\n  `;\n\n  @property(propertyOptions)\n  from = '';\n  @property(propertyOptions)\n  time = '';\n  @property(propertyOptions)\n  subject = '';\n\n  protected override render() {\n    return html`\n      <div class=\"container\">\n        <span class=\"from\">${this.from}</span>\n        <span class=\"time\">${this.time}</span>\n        <div class=\"subject\">${this.subject}</div>\n      </div>\n    `;\n  }\n}\n\n@customElement('x-item')\nexport class XItem extends LitElement {\n  static override styles = css`\n    .item {\n      display: flex;\n    }\n  `;\n\n  @property()\n  item!: SimpleItem;\n\n  protected override render() {\n    return html`\n      <div @click=\"${this.onClick}\" class=\"item\">\n        <x-thing\n          .from=\"${this.item.value0}\"\n          .time=\"${this.item.value1}\"\n          .subject=\"${this.item.value2}\"\n        ></x-thing>\n        <x-thing\n          .from=\"${this.item.value3}\"\n          .time=\"${this.item.value4}\"\n          .subject=\"${this.item.value5}\"\n        ></x-thing>\n        <x-thing\n          .from=\"${this.item.value6}\"\n          .time=\"${this.item.value7}\"\n          .subject=\"${this.item.value8}\"\n        ></x-thing>\n        <x-thing\n          .from=\"${this.item.value9}\"\n          .time=\"${this.item.value10}\"\n          .subject=\"${this.item.value11}\"\n        ></x-thing>\n        <x-thing\n          .from=\"${this.item.value12}\"\n          .time=\"${this.item.value13}\"\n          .subject=\"${this.item.value14}\"\n        ></x-thing>\n        <x-thing\n          .from=\"${this.item.value15}\"\n          .time=\"${this.item.value16}\"\n          .subject=\"${this.item.value17}\"\n        ></x-thing>\n      </div>\n    `;\n  }\n\n  onClick(e: MouseEvent) {\n    console.log(e.type);\n  }\n}\n\n@customElement('x-app')\nexport class XApp extends LitElement {\n  @property()\n  items = data;\n\n  protected override render() {\n    return html`${this.items.map(\n      (item) => html`<x-item .item=\"${item}\"></x-item>`\n    )}`;\n  }\n}\n\n(async () => {\n  const container = document.createElement('div');\n  document.body.appendChild(container);\n  let el: XApp;\n\n  const create = () => {\n    render(html`<x-app></x-app>`, document.body);\n    return document.body.firstElementChild as XApp;\n  };\n\n  const destroy = () => {\n    container.innerHTML = '';\n  };\n\n  const updateComplete = () => new Promise((r) => requestAnimationFrame(r));\n\n  const benchmark = queryParams['benchmark'];\n  const getTestStartName = (name: string) => `${name}-start`;\n\n  // Named functions are use to run the measurements so that they can be\n  // selected in the DevTools profile flame chart.\n\n  // Initial Render\n  const initialRender = async () => {\n    const test = 'render';\n    if (benchmark === test || !benchmark) {\n      const start = getTestStartName(test);\n      performance.mark(start);\n      create();\n      await updateComplete();\n      performance.measure(test, start);\n      destroy();\n    }\n  };\n  await initialRender();\n\n  // Update: toggle data\n  const update = async () => {\n    const test = 'update';\n    if (benchmark === test || !benchmark) {\n      el = create();\n      const start = getTestStartName(test);\n      performance.mark(start);\n      for (let i = 0; i < updateCount; i++) {\n        el.items = i % 2 ? otherData : data;\n        await updateComplete();\n      }\n      performance.measure(test, start);\n      destroy();\n    }\n  };\n  await update();\n\n  const updateReflect = async () => {\n    const test = 'update-reflect';\n    if (benchmark === test || !benchmark) {\n      el = create();\n      const start = getTestStartName(test);\n      performance.mark(start);\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      (propertyOptions as any).reflect = true;\n      for (let i = 0; i < updateCount; i++) {\n        el.items = i % 2 ? otherData : data;\n        await updateComplete();\n      }\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      (propertyOptions as any).reflect = false;\n      performance.measure(test, start);\n      destroy();\n    }\n  };\n  await updateReflect();\n\n  // Log\n  performance\n    .getEntriesByType('measure')\n    .forEach((m) => console.log(`${m.name}: ${m.duration.toFixed(3)}ms`));\n})();\n"]}